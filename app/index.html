<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="../bower_components/normalize-css/normalize.css"/>
    <link rel="stylesheet" href="../bower_components/font-awesome/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="../bower_components/highlightjs/styles/tomorrow.css"/>
    <link rel="stylesheet" href="../bower_components/ruban/css/ruban.min.css"/>
    <link rel="stylesheet" href="../style/my-prettify.css"/>
    <link rel="stylesheet" href="../bower_components/ruban/css/ruban-print.min.css" media="print"/>

    <script src="../bower_components/google-code-prettify/bin/run_prettify.min.js"></script>

    <title>Testable code</title>
</head>
<body>

<section class="no-toc">
    <h1><i class="fa fa-code"></i><br/>I want to write testale code <br/><i class="fa fa-code"></i></h1>
</section>

<section class="toc">
    <h1>Summary</h1>
</section>

<section>
    <h1>Testability issues</h1>
</section>

<section class="no-toc">
    <h1>Can’t instantiate a class</h1>
    <ul style="margin-top: -50px">
        <li>Static initialization</li>
        <pre class="prettyprint">
            static {
                ...
            }
            public Constructor() {
            ...
            }
        </pre>
        <li>Rely on collaborators that need to be initialized</li>
        <pre class="prettyprint">
            @BeforeClass
            public static void initEnvironement() {
                new BonitaRestAPIServlet();
                I18n.getInstance();
            }
            @Test
            public void testUsingAnAPI() {
                APIComment apiComment = new APIComment();
                ...
            }
        </pre>
        <li>Too much collaborators</li>
    </ul>
</section>

<section class="no-toc">
    <h1>Can’t invoke a method</h1>
    <ul>
        <li>Private visibility</li>
        <li>Opacity <small>can’t figure out what the method expects to receive as its arguments (java.util.Map ?)</small></li>
    </ul>
</section>

<section class="no-toc">
    <h1 style="margin-bottom: 0px;"><small>Can’t observe the outcome</small></h1>
    <small>Find yourself incapable of intercepting the interaction you’re interested in</small>
    <ul>
        <li>Hard-wired collaborators</li>
        <li>Multithreading / events</li>
    </ul>
    <ul>
        <li>Ties closely to trouble to substitute parts of the implementation</li>
    </ul>
</section>

<section class="no-toc">
    <h1>Can’t substitute a collaborator </h1>
    <ul>
        <li>Hardcoded new Collaborator()</li>
        <li>Method chain: getCollaborator().doStuff().askForStuff().doMoreStuff()</li>
    </ul>
</section>

<section class="no-toc">
    <h1>Can’t override a method</h1>
    <ul>
        <li>private static final Collaborator getCollaborator() { ... }</li>
    </ul>
</section>

<section>
    <h1>Testable design</h1>
</section>

<section class="no-toc">
    <h1>Avoid complex private methods</h1>
</section>

<section class="no-toc">
    <h1>Avoid final methods</h1>
    <span>perf final ????</span>
</section>

<section class="no-toc">
    <h1>Avoid static methods</h1>
</section>

<section class="no-toc">
    <h1>Use new with care</h1>
</section>

<section class="no-toc">
    <h1>Avoid logic in constructors</h1>
</section>

<section class="no-toc">
    <h1>Avoid the Singleton</h1>
</section>

<section class="no-toc">
    <h1>Favor composition over inheritance</h1>
</section>

<section class="no-toc">
    <h1>Wrap external libraries</h1>
</section>

<section class="no-toc">
    <h1>Avoid service lookups</h1>
</section>

<script src="../bower_components/jquery/jquery.min.js"></script>
<script src="../bower_components/keymaster/keymaster.js"></script>
<script src="../bower_components/hammerjs/hammer.min.js"></script>
<script src="../bower_components/highlightjs/highlight.pack.js"></script>
<script src="../bower_components/ruban/js/ruban.min.js"></script>
<script>
    new Ruban({
        pagination: true
    });
</script>
</body>
</html>